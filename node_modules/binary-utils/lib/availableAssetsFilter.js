'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _epochToUTCTimeString = require('./epochToUTCTimeString');

var _epochToUTCTimeString2 = _interopRequireDefault(_epochToUTCTimeString);

var _timeStringIsBetween = require('./timeStringIsBetween');

var _timeStringIsBetween2 = _interopRequireDefault(_timeStringIsBetween);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function (assets, times, now) {
    var nowInTimeString = (0, _epochToUTCTimeString2.default)(now);
    var availabilities = {};

    times.forEach(function (s) {
        if (!s.times) {
            return;
        }
        var open = s.times.open;
        var close = s.times.close;

        // Assuming closing time is larger than open time
        if (s.name.indexOf('Random') > -1) {
            availabilities[s.symbol] = true;
        } else if (open.length === 1) {
            if ((0, _timeStringIsBetween2.default)(open[0], close[0], nowInTimeString)) {
                availabilities[s.symbol] = true;
            }
        } else if (open.length === 2) {
            if ((0, _timeStringIsBetween2.default)(open[0], close[0], nowInTimeString) || (0, _timeStringIsBetween2.default)(open[1], close[1], nowInTimeString)) {
                availabilities[s.symbol] = true;
            }
        }
    });
    var availableAssets = assets.filter(function (s) {
        return availabilities[s.value];
    });

    return availableAssets;
};